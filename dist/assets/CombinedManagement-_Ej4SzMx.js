import{r as o,x as e,B as g,V as n,H as D,S as k}from"./index-3j2E7pUL.js";import z from"./UserManagement-CLvQm_C9.js";import M from"./DepartmentManagement-DwKunVX1.js";import T from"./TeamManagement-bn18z5_F.js";import{i as c}from"./axios-CSlAuMiO.js";import{F as S}from"./index-jd3XYpcD.js";import{R as v}from"./PlusOutlined-BdSH2k4o.js";import{F as I}from"./Table-HKvwWm1_.js";import{D as R}from"./index-DVSodFTC.js";import{I as E}from"./index-CsUGJ7YV.js";import{R as A}from"./EditOutlined-0_cnfjzU.js";import{P}from"./index-CFb1Uy8W.js";import{R as B}from"./DeleteOutlined-BAvkxAoL.js";import{T as Z}from"./index-BRTO4pFo.js";import"./index-DiojptZP.js";import"./TextArea-DELUlYzR.js";import"./SwapOutlined-CsU7PVtz.js";import"./Collapse-D2oiVkKu.js";import"./index-BoISyFuH.js";import"./extendsObject-78o_rR5W.js";import"./row-BatVd8KW.js";import"./Pagination-Buu9EMH_.js";import"./TeamOutlined-06P04d5g.js";import"./styleChecker-D89VOBbV.js";import"./addEventListener-BJarX3AI.js";import"./index-CfNZZRpy.js";import"./context-DJnMqWkY.js";import"./useClosable-CC1Ls4ip.js";import"./ActionButton-RId_fRI3.js";const N=()=>{const[y,C]=o.useState([]),[u,l]=o.useState(!1),[m,j]=o.useState(null),[d]=S.useForm(),f=async()=>{try{const t=await c.get("/api/zones");C(t.data)}catch{n.error("Failed to load zones")}};o.useEffect(()=>{f()},[]);const F=()=>{j(null),d.resetFields(),l(!0)},b=t=>{j(t),d.setFieldsValue(t),l(!0)},r=async()=>{var t,s;try{const a=await d.validateFields();m?(await c.put(`/api/zones/${m._id}`,a),n.success("Zone updated successfully")):(await c.post("/api/zones",a),n.success("Zone created successfully")),l(!1),f()}catch(a){n.error(((s=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to save zone")}},h=async t=>{var s,a;try{await c.delete(`/api/zones/${t}`),n.success("Zone deleted"),f()}catch(p){n.error(((a=(s=p==null?void 0:p.response)==null?void 0:s.data)==null?void 0:a.message)||"Delete failed")}},x=[{title:"Zone Name",dataIndex:"name",key:"name"},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(D,{children:[e.jsx(g,{icon:e.jsx(A,{}),onClick:()=>b(s)}),e.jsx(P,{title:"Are you sure to delete this zone?",onConfirm:()=>h(s._id),okText:"Yes",cancelText:"No",children:e.jsx(g,{danger:!0,icon:e.jsx(B,{})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h2",{children:"Zone Management"}),e.jsx(g,{type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},icon:e.jsx(v,{}),onClick:F,children:"Create Zone"})]}),e.jsx(I,{columns:x,dataSource:y,rowKey:"_id",bordered:!0}),e.jsx(R,{title:m?"Edit Zone":"Create Zone",open:u,onClose:()=>l(!1),width:400,styles:{body:{paddingBottom:80}},footer:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(g,{onClick:()=>l(!1),style:{marginRight:8},children:"Cancel"}),e.jsx(g,{onClick:r,type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},children:m?"Update":"Create"})]}),children:e.jsx(S,{form:d,layout:"vertical",children:e.jsx(S.Item,{name:"name",label:"Zone Name",rules:[{required:!0,message:"Please enter the zone name"}],children:e.jsx(E,{})})})})]})},{TabPane:w}=Z,fe=()=>{const[y,C]=o.useState([]),[u,l]=o.useState([]),[m,j]=o.useState([]),[d,f]=o.useState([]),[F,b]=o.useState(!0),r=JSON.parse(localStorage.getItem("user")),h=(r==null?void 0:r.role)==="Superadmin",x=(r==null?void 0:r.role)==="Admin";r==null||r.role;const t=o.useCallback(async()=>{try{const i=await c.get("/api/users");C(i.data)}catch{n.error("Failed to load users")}},[]),s=o.useCallback(async()=>{try{const i=await c.get("/api/departments");l(i.data)}catch{n.error("Failed to load departments")}},[]),a=o.useCallback(async()=>{try{const i=await c.get("/api/teams");j(i.data)}catch{n.error("Failed to load teams")}},[]),p=o.useCallback(async()=>{try{const i=await c.get("/api/zones");f(i.data)}catch{n.error("Failed to load zones")}},[]);return o.useEffect(()=>{(async()=>{b(!0),await Promise.all([t(),s(),a(),p()]),b(!1)})()},[t,s,a,p]),F?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(k,{size:"large"})}):e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h1",{children:"Management Dashboard"}),e.jsxs(Z,{defaultActiveKey:"users",type:"card",children:[e.jsx(w,{tab:"User Management",children:e.jsx(z,{users:y,departments:u,teams:m,zones:d,fetchUsers:t,fetchDepartments:s,fetchTeams:a})},"users"),(h||x)&&e.jsx(w,{tab:"Department Management",children:e.jsx(M,{departments:u,fetchDepartments:s,fetchTeams:a,fetchUsers:t})},"departments"),(h||x)&&e.jsx(w,{tab:"Team Management",children:e.jsx(T,{teams:m,departments:u,allUsers:y,fetchTeams:a,fetchDepartments:s,fetchUsers:t})},"teams"),(h||x)&&e.jsx(w,{tab:"Zone Management",children:e.jsx(N,{zones:d,fetchZones:p})},"zones")]})]})};export{fe as default};
