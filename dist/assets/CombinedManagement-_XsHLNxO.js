import{r as n,X as S,U as e,a0 as y,bd as D,a2 as k,aC as z,a4 as M,a6 as c,ar as r,ao as v,aa as T,an as I,bb as F}from"./index-CdWk2t8q.js";import E from"./UserManagement-PBVOpfDN.js";import A from"./DepartmentManagement-CpsOVGyK.js";import R from"./TeamManagement-BuPpGEf1.js";import{P}from"./index-BWEg3k1d.js";import{R as N}from"./DeleteOutlined-ArRDP0IZ.js";import"./SwapOutlined-DShqZRvZ.js";import"./Collapse-DY9Hyfff.js";import"./TeamOutlined-UTGEOi27.js";const _=()=>{const[f,w]=n.useState([]),[p,l]=n.useState(!1),[d,j]=n.useState(null),[m]=S.useForm(),h=async()=>{try{const t=await c.get("/api/zones");w(t.data)}catch{r.error("Failed to load zones")}};n.useEffect(()=>{h()},[]);const Z=()=>{j(null),m.resetFields(),l(!0)},b=t=>{j(t),m.setFieldsValue(t),l(!0)},o=async()=>{var t,s;try{const a=await m.validateFields();d?(await c.put(`/api/zones/${d._id}`,a),r.success("Zone updated successfully")):(await c.post("/api/zones",a),r.success("Zone created successfully")),l(!1),h()}catch(a){r.error(((s=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to save zone")}},x=async t=>{var s,a;try{await c.delete(`/api/zones/${t}`),r.success("Zone deleted"),h()}catch(u){r.error(((a=(s=u==null?void 0:u.response)==null?void 0:s.data)==null?void 0:a.message)||"Delete failed")}},g=[{title:"Zone Name",dataIndex:"name",key:"name"},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(v,{children:[e.jsx(y,{icon:e.jsx(T,{}),onClick:()=>b(s)}),e.jsx(P,{title:"Are you sure to delete this zone?",onConfirm:()=>x(s._id),okText:"Yes",cancelText:"No",children:e.jsx(y,{danger:!0,icon:e.jsx(N,{})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h2",{children:"Zone Management"}),e.jsx(y,{type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},icon:e.jsx(D,{}),onClick:Z,children:"Create Zone"})]}),e.jsx(k,{columns:g,dataSource:f,rowKey:"_id",bordered:!0}),e.jsx(z,{title:d?"Edit Zone":"Create Zone",open:p,onClose:()=>l(!1),width:400,styles:{body:{paddingBottom:80}},footer:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(y,{onClick:()=>l(!1),style:{marginRight:8},children:"Cancel"}),e.jsx(y,{onClick:o,type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},children:d?"Update":"Create"})]}),children:e.jsx(S,{form:m,layout:"vertical",children:e.jsx(S.Item,{name:"name",label:"Zone Name",rules:[{required:!0,message:"Please enter the zone name"}],children:e.jsx(M,{})})})})]})},{TabPane:C}=F,X=()=>{const[f,w]=n.useState([]),[p,l]=n.useState([]),[d,j]=n.useState([]),[m,h]=n.useState([]),[Z,b]=n.useState(!0),o=JSON.parse(localStorage.getItem("user")),x=(o==null?void 0:o.role)==="Superadmin",g=(o==null?void 0:o.role)==="Admin";o==null||o.role;const t=n.useCallback(async()=>{try{const i=await c.get("/api/users");w(i.data)}catch{r.error("Failed to load users")}},[]),s=n.useCallback(async()=>{try{const i=await c.get("/api/departments");l(i.data)}catch{r.error("Failed to load departments")}},[]),a=n.useCallback(async()=>{try{const i=await c.get("/api/teams");j(i.data)}catch{r.error("Failed to load teams")}},[]),u=n.useCallback(async()=>{try{const i=await c.get("/api/zones");h(i.data)}catch{r.error("Failed to load zones")}},[]);return n.useEffect(()=>{(async()=>{b(!0),await Promise.all([t(),s(),a(),u()]),b(!1)})()},[t,s,a,u]),Z?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(I,{size:"large"})}):e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h1",{children:"Management Dashboard"}),e.jsxs(F,{defaultActiveKey:"users",type:"card",children:[e.jsx(C,{tab:"User Management",children:e.jsx(E,{users:f,departments:p,teams:d,zones:m,fetchUsers:t,fetchDepartments:s,fetchTeams:a})},"users"),(x||g)&&e.jsx(C,{tab:"Department Management",children:e.jsx(A,{departments:p,fetchDepartments:s,fetchTeams:a,fetchUsers:t})},"departments"),(x||g)&&e.jsx(C,{tab:"Team Management",children:e.jsx(R,{teams:d,departments:p,allUsers:f,fetchTeams:a,fetchDepartments:s,fetchUsers:t})},"teams"),(x||g)&&e.jsx(C,{tab:"Zone Management",children:e.jsx(_,{zones:m,fetchZones:u})},"zones")]})]})};export{X as default};
