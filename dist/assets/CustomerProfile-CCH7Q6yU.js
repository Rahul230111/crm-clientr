import{r as l,a6 as X,a9 as re,f as F,bk as xe,bl as he,g as be,m as ye,b as Ne,u as G,bm as je,bn as W,ad as ve,I as B,k as L,bo as we,ah as Ce,$,K as t,af as Ie,Q as Z,T as Oe,bh as k,L as Se,P as q,aU as ae,W as Ae,aZ as J}from"./index-FVmEbnB1.js";import{D as f}from"./index-Dl_ShrvA.js";import{C as se}from"./Collapse-BGJArvLw.js";import{R as Pe}from"./FallOutlined-DHsOBdOF.js";const D=({children:e})=>{const{getPrefixCls:n}=l.useContext(X),r=n("breadcrumb");return l.createElement("li",{className:`${r}-separator`,"aria-hidden":"true"},e===""?e:e||"/")};D.__ANT_BREADCRUMB_SEPARATOR=!0;var $e=function(e,n){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)n.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]]);return r};function Ee(e,n){if(e.title===void 0||e.title===null)return null;const r=Object.keys(n).join("|");return typeof e.title=="object"?e.title:String(e.title).replace(new RegExp(`:(${r})`,"g"),(a,o)=>n[o]||a)}function ne(e,n,r,a){if(r==null)return null;const{className:o,onClick:m}=n,u=$e(n,["className","onClick"]),g=Object.assign(Object.assign({},re(u,{data:!0,aria:!0})),{onClick:m});return a!==void 0?l.createElement("a",Object.assign({},g,{className:F(`${e}-link`,o),href:a}),r):l.createElement("span",Object.assign({},g,{className:F(`${e}-link`,o)}),r)}function Re(e,n){return(a,o,m,u,g)=>{if(n)return n(a,o,m,u);const b=Ee(a,o);return ne(e,a,b,g)}}var M=function(e,n){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)n.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]]);return r};const oe=e=>{const{prefixCls:n,separator:r="/",children:a,menu:o,overlay:m,dropdownProps:u,href:g}=e,N=(j=>{if(o||m){const v=Object.assign({},u);if(o){const S=o||{},{items:w}=S,p=M(S,["items"]);v.menu=Object.assign(Object.assign({},p),{items:w==null?void 0:w.map((x,h)=>{var{key:y,title:s,label:i,path:c}=x,C=M(x,["key","title","label","path"]);let I=i??s;return c&&(I=l.createElement("a",{href:`${g}${c}`},I)),Object.assign(Object.assign({},C),{key:y??h,label:I})})})}else m&&(v.overlay=m);return l.createElement(xe,Object.assign({placement:"bottom"},v),l.createElement("span",{className:`${n}-overlay-link`},j,l.createElement(he,null)))}return j})(a);return N!=null?l.createElement(l.Fragment,null,l.createElement("li",null,N),r&&l.createElement(D,null,r)):null},le=e=>{const{prefixCls:n,children:r,href:a}=e,o=M(e,["prefixCls","children","href"]),{getPrefixCls:m}=l.useContext(X),u=m("breadcrumb",n);return l.createElement(oe,Object.assign({},o,{prefixCls:u}),ne(u,o,r,a))};le.__ANT_BREADCRUMB_ITEM=!0;const Be=e=>{const{componentCls:n,iconCls:r,calc:a}=e;return{[n]:Object.assign(Object.assign({},Ne(e)),{color:e.itemColor,fontSize:e.fontSize,[r]:{fontSize:e.iconFontSize},ol:{display:"flex",flexWrap:"wrap",margin:0,padding:0,listStyle:"none"},a:Object.assign({color:e.linkColor,transition:`color ${e.motionDurationMid}`,padding:`0 ${G(e.paddingXXS)}`,borderRadius:e.borderRadiusSM,height:e.fontHeight,display:"inline-block",marginInline:a(e.marginXXS).mul(-1).equal(),"&:hover":{color:e.linkHoverColor,backgroundColor:e.colorBgTextHover}},je(e)),"li:last-child":{color:e.lastItemColor},[`${n}-separator`]:{marginInline:e.separatorMargin,color:e.separatorColor},[`${n}-link`]:{[`
          > ${r} + span,
          > ${r} + a
        `]:{marginInlineStart:e.marginXXS}},[`${n}-overlay-link`]:{borderRadius:e.borderRadiusSM,height:e.fontHeight,display:"inline-block",padding:`0 ${G(e.paddingXXS)}`,marginInline:a(e.marginXXS).mul(-1).equal(),[`> ${r}`]:{marginInlineStart:e.marginXXS,fontSize:e.fontSizeIcon},"&:hover":{color:e.linkHoverColor,backgroundColor:e.colorBgTextHover,a:{color:e.linkHoverColor}},a:{"&:hover":{backgroundColor:"transparent"}}},[`&${e.componentCls}-rtl`]:{direction:"rtl"}})}},Le=e=>({itemColor:e.colorTextDescription,lastItemColor:e.colorText,iconFontSize:e.fontSize,linkColor:e.colorTextDescription,linkHoverColor:e.colorText,separatorColor:e.colorTextDescription,separatorMargin:e.marginXS}),De=be("Breadcrumb",e=>{const n=ye(e,{});return Be(n)},Le);var Y=function(e,n){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)n.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]]);return r};function ze(e){const{breadcrumbName:n,children:r}=e,a=Y(e,["breadcrumbName","children"]),o=Object.assign({title:n},a);return r&&(o.menu={items:r.map(m=>{var{breadcrumbName:u}=m,g=Y(m,["breadcrumbName"]);return Object.assign(Object.assign({},g),{title:u})})}),o}function Te(e,n){return l.useMemo(()=>e||(n?n.map(ze):null),[e,n])}var He=function(e,n){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)n.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]]);return r};const _e=(e,n)=>{if(n===void 0)return n;let r=(n||"").replace(/^\//,"");return Object.keys(e).forEach(a=>{r=r.replace(`:${a}`,e[a])}),r},V=e=>{const{prefixCls:n,separator:r="/",style:a,className:o,rootClassName:m,routes:u,items:g,children:b,itemRender:N,params:j={}}=e,v=He(e,["prefixCls","separator","style","className","rootClassName","routes","items","children","itemRender","params"]),{getPrefixCls:S,direction:w,breadcrumb:p}=l.useContext(X);let x;const h=S("breadcrumb",n),[y,s,i]=De(h),c=Te(g,u),C=Re(h,N);if(c&&c.length>0){const A=[],P=g||u;x=c.map((O,E)=>{const{path:ce,key:z,type:de,menu:Q,overlay:K,onClick:me,className:ue,separator:fe,dropdownProps:ge}=O,T=_e(j,ce);T!==void 0&&A.push(T);const U=z??E;if(de==="separator")return l.createElement(D,{key:U},fe);const H={},pe=E===c.length-1;Q?H.menu=Q:K&&(H.overlay=K);let{href:_}=O;return A.length&&T!==void 0&&(_=`#/${A.join("/")}`),l.createElement(oe,Object.assign({key:U},H,re(O,{data:!0,aria:!0}),{className:ue,dropdownProps:ge,href:_,separator:pe?"":r,onClick:me,prefixCls:h}),C(O,j,P,A,_))})}else if(b){const A=W(b).length;x=W(b).map((P,O)=>{if(!P)return P;const E=O===A-1;return ve(P,{separator:E?"":r,key:O})})}const I=F(h,p==null?void 0:p.className,{[`${h}-rtl`]:w==="rtl"},o,m,s,i),ie=Object.assign(Object.assign({},p==null?void 0:p.style),a);return y(l.createElement("nav",Object.assign({className:I,style:ie},v),l.createElement("ol",null,x)))};V.Item=le;V.Separator=D;var ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},Fe=function(n,r){return l.createElement(B,L({},n,{ref:r,icon:ke}))},ee=l.forwardRef(Fe),Me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"},Xe=function(n,r){return l.createElement(B,L({},n,{ref:r,icon:Me}))},Ve=l.forwardRef(Xe),Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},Ke=function(n,r){return l.createElement(B,L({},n,{ref:r,icon:Qe}))},Ue=l.forwardRef(Ke),Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},We=function(n,r){return l.createElement(B,L({},n,{ref:r,icon:Ge}))},Ze=l.forwardRef(We);const{TabPane:te}=ae,{Title:R,Text:d}=Oe,{Panel:qe}=se,rt=()=>{const{id:e}=we(),n=Ce(),[r,a]=l.useState(null),[o,m]=l.useState(!0),[u,g]=l.useState([]),[b,N]=l.useState([]),[j,v]=l.useState([]),[S,w]=l.useState([]);if(l.useEffect(()=>{m(!0),Promise.all([$.get(`/api/accounts/${e}`),$.get(`/api/quotations/business/${e}`),$.get(`/api/invoices/business/${e}`),$.get(`/api/accounts/${e}/followups`),$.get(`/api/invoices/business/${e}/payments`)]).then(([s,i,c,C,I])=>{a(s.data),g(i.data||[]),N(c.data||[]),v(C.data||[]),w(I.data||[])}).catch(s=>{console.error("Failed to load data:",s)}).finally(()=>m(!1))},[e]),o)return t.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-50",children:t.jsx(Ie,{size:"large",tip:"Loading Customer Profile..."})});if(!r)return t.jsxs("div",{className:"p-6 bg-white shadow-lg rounded-lg m-6",children:[t.jsx(Z,{className:"mb-4 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-md transition duration-300 ease-in-out",icon:t.jsx(ee,{}),onClick:()=>n("/customers"),children:"Back to Customers"}),t.jsx(R,{level:3,className:"mt-4 text-center text-gray-700",children:"Customer Not Found"}),t.jsx(k,{description:"No data found for this customer ID. It might not exist or there was an issue fetching it.",className:"mt-8"})]});const p=[...j.map(s=>({...s,type:"Follow-up",date:s.followupDate||s.date})),...(r.notes||[]).map(s=>({...s,type:"Note",date:s.timestamp}))].sort((s,i)=>new Date(i.date)-new Date(s.date)),x=s=>`₹${Number(s||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,h=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}catch(i){return console.error("Error formatting date:",s,i),s}},y=s=>{const i=[];return s.addressLine1&&i.push(s.addressLine1),s.addressLine2&&i.push(s.addressLine2),s.addressLine3&&i.push(s.addressLine3),s.city&&i.push(s.city),s.state&&i.push(s.state),s.pincode&&i.push(s.pincode),s.country&&i.push(s.country),i.length>0?i.join(", "):"N/A"};return b.reduce((s,i)=>s+(i.totalAmount||0),0),S.reduce((s,i)=>s+(i.amount||0),0),t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen font-sans",children:[t.jsx(Z,{className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out flex items-center space-x-2 customer-profile-back-button",icon:t.jsx(ee,{}),onClick:()=>n(-1),children:"Back"}),t.jsx(V,{className:"mb-4 text-gray-600 mt-5 font-medium",items:[{title:"Customers",href:"/customers"},{title:r.businessName||"Profile"}]}),t.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-4 sm:space-y-0",children:t.jsxs(R,{level:2,className:"text-gray-800 font-extrabold mb-0 text-center sm:text-left text-gradient-blue-purple",children:[" ",r.businessName," Profile"]})}),t.jsx(Se,{title:t.jsx(R,{level:4,className:"text-gray-800 font-bold mb-0",children:"Customer Details"}),className:"shadow-xl rounded-xl mb-8 border-t-8 border-blue-600 transform hover:scale-100 transition duration-300 ease-in-out",children:t.jsxs(f,{bordered:!0,column:{xs:1,sm:2,md:2,lg:3},size:"middle",className:"text-gray-700",children:[t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Business Name"}),children:t.jsx(d,{strong:!0,className:"text-gray-900",children:r.businessName||"N/A"})}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"GSTIN"}),children:r.gstNumber||"N/A"}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Customer Name"}),children:r.contactName||"N/A"}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Email"}),children:r.email||"N/A"}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Phone Number"}),children:r.phoneNumber||"N/A"}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Status"}),children:t.jsx(q,{color:r.status==="Active"?"green":r.status==="Inactive"?"red":"blue",className:"rounded-full px-3 py-1 text-sm font-medium",children:r.status||"N/A"})}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Type"}),children:r.type||"N/A"}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Customer Address"}),span:3,children:y(r)}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Created At"}),children:r.createdAt?new Date(r.createdAt).toLocaleString():"N/A"}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Last Updated"}),children:r.updatedAt?new Date(r.updatedAt).toLocaleString():"N/A"})]})}),t.jsxs(ae,{defaultActiveKey:"1",className:"bg-white p-4 rounded-xl shadow-xl",tabBarStyle:{marginBottom:24},children:[t.jsx(te,{tab:t.jsxs("span",{className:"flex items-center space-x-2 text-lg font-semibold text-gray-700 hover:text-blue-600 transition-colors duration-200",children:[t.jsx(Pe,{className:"text-xl"}),t.jsxs("span",{children:["Quotations (",u.length,")"]})]}),children:u.length===0?t.jsx(k,{description:"No quotations found for this customer.",className:"py-8"}):t.jsx(se,{accordion:!0,className:"shadow-md rounded-lg overflow-hidden",expandIconPosition:"end",children:u.map((s,i)=>t.jsxs(qe,{header:t.jsxs("div",{className:"font-semibold text-lg flex justify-between items-center py-2",children:[t.jsxs("span",{className:"text-gray-800",children:["Quotation #",s.quotationNumber||"N/A"]}),t.jsx("span",{className:"text-green-600 text-xl font-bold",children:x(s.totalAmount)})]}),className:"bg-white border-b border-gray-200 rounded-lg mb-2 overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-200 ease-in-out",children:[t.jsxs(f,{bordered:!0,column:{xs:1,sm:2,md:2},size:"small",className:"mb-4 text-gray-700",children:[t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Date"}),children:h(s.date)}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Status"}),children:t.jsx(q,{color:s.status==="Approved"?"green":s.status==="Pending"?"orange":s.status==="Rejected"?"red":"blue",className:"rounded-full px-3 py-1 text-sm font-medium",children:s.status||"N/A"})}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Customer Name"}),children:r.contactName||"N/A"}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"GSTIN"}),children:r.gstNumber||"N/A"}),t.jsx(f.Item,{label:t.jsx(d,{strong:!0,className:"text-gray-600",children:"Customer Address"}),span:2,children:y(r)})]}),t.jsx(R,{level:5,className:"mt-6 mb-3 text-gray-800 font-bold",children:"Items Quoted"}),t.jsx(Ae,{dataSource:s.items||[],columns:[{title:"Product Name",dataIndex:"productName",key:"productName",render:c=>c||"N/A"},{title:"Description",dataIndex:"description",key:"description"},{title:"HSN/SAC",dataIndex:"hsn",key:"hsn"},{title:"Qty",dataIndex:"quantity",key:"quantity"},{title:"Rate (₹)",dataIndex:"rate",key:"rate",render:c=>x(c)},{title:"Amount (₹)",dataIndex:"amount",key:"amount",render:c=>x(c)}],pagination:!1,rowKey:(c,C)=>C,size:"small",className:"border border-gray-200 rounded-md overflow-hidden shadow-sm"})]},s._id||i))})},"1"),t.jsx(te,{tab:t.jsxs("span",{className:"flex items-center space-x-2 text-lg font-semibold text-gray-700 hover:text-blue-600 transition-colors duration-200",children:[t.jsx(Ze,{className:"text-xl"}),t.jsxs("span",{children:["History (",p.length,")"]})]}),children:p.length===0?t.jsx(k,{description:"No follow-ups or notes found for this customer.",className:"py-8"}):t.jsx(J,{bordered:!0,dataSource:p,className:"rounded-lg overflow-hidden shadow-md",renderItem:s=>{var i,c;return t.jsxs(J.Item,{className:"flex flex-col items-start bg-white p-5 hover:bg-gray-50 transition-colors duration-200 border-b border-gray-200 last:border-b-0 customer-profile-list-item-hover",children:[" ",t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"font-semibold text-gray-800 text-base mb-2 flex items-center",children:[t.jsx("span",{className:"mr-3 text-blue-500 text-xl",children:s.type==="Follow-up"?t.jsx(Ue,{}):t.jsx(Ve,{})}),t.jsxs(d,{strong:!0,children:[s.type,":"]})," ",t.jsx("span",{className:"ml-2",children:s.text||s.note||s.comment||"N/A"})]}),t.jsxs("div",{className:"text-sm text-gray-500 mt-3 border-t border-gray-100 pt-2",children:["Added by: ",t.jsx(d,{italic:!0,children:((i=s.addedBy)==null?void 0:i.name)||((c=s.addedBy)==null?void 0:c.email)||s.author||"Unknown"})," | ",h(s.date)]})]})]})}})},"4")]})]})};export{rt as default};
