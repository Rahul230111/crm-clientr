import{r as h,x as e,B as n,H as k,V as i}from"./index-3j2E7pUL.js";import{i as d}from"./axios-CSlAuMiO.js";import{F as p}from"./index-jd3XYpcD.js";import{R}from"./PlusOutlined-BdSH2k4o.js";import{F as v}from"./Table-HKvwWm1_.js";import{D as E}from"./index-DVSodFTC.js";import{I as A}from"./index-CsUGJ7YV.js";import{R as O}from"./EditOutlined-0_cnfjzU.js";import{P as _}from"./index-CFb1Uy8W.js";import{R as $}from"./DeleteOutlined-BAvkxAoL.js";import"./row-BatVd8KW.js";import"./TextArea-DELUlYzR.js";import"./styleChecker-D89VOBbV.js";import"./addEventListener-BJarX3AI.js";import"./index-DiojptZP.js";import"./index-CfNZZRpy.js";import"./Pagination-Buu9EMH_.js";import"./extendsObject-78o_rR5W.js";import"./context-DJnMqWkY.js";import"./useClosable-CC1Ls4ip.js";import"./ActionButton-RId_fRI3.js";const re=({departments:D,fetchDepartments:u,fetchTeams:x,fetchUsers:f})=>{const[C,o]=h.useState(!1),[m,g]=h.useState(null),[l]=p.useForm(),s=JSON.parse(localStorage.getItem("user")),j=(s==null?void 0:s.role)==="Superadmin",y=(s==null?void 0:s.role)==="Admin",w=()=>{g(null),l.resetFields(),o(!0)},F=r=>{g(r),l.setFieldsValue({name:r.name,description:r.description}),o(!0)},b=async()=>{var r,a;try{const t=await l.validateFields();m?(await d.put(`/api/departments/${m._id}`,t),i.success("Department updated successfully")):(await d.post("/api/departments",t),i.success("Department created successfully")),o(!1),u(),x(),f()}catch(t){console.error(t),i.error(((a=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to submit department")}},I=async r=>{var a,t;try{await d.delete(`/api/departments/${r}`),i.success("Department deleted"),u(),x(),f()}catch(c){i.error(((t=(a=c==null?void 0:c.response)==null?void 0:a.data)==null?void 0:t.message)||"Delete failed")}},S=[{title:"Name",dataIndex:"name",key:"name"},{title:"Actions",key:"actions",render:(r,a)=>e.jsx(k,{children:(j||y)&&e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:e.jsx(O,{}),onClick:()=>F(a)}),e.jsx(_,{title:"Delete this department?",onConfirm:()=>I(a._id),children:e.jsx(n,{danger:!0,icon:e.jsx($,{})})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Department Management"}),(j||y)&&e.jsx(n,{type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},icon:e.jsx(R,{}),onClick:w,children:"Create Department"})]}),e.jsx(v,{columns:S,dataSource:D,rowKey:"_id",bordered:!0}),e.jsx(E,{title:m?"Edit Department":"Create Department",open:C,onClose:()=>o(!1),width:420,destroyOnClose:!0,footer:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(n,{onClick:()=>o(!1),style:{marginRight:8},children:"Cancel"}),e.jsx(n,{type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},onClick:b,children:m?"Update":"Create"})]}),children:e.jsx(p,{form:l,layout:"vertical",children:e.jsx(p.Item,{name:"name",label:"Department Name",rules:[{required:!0,message:"Department name is required"}],children:e.jsx(A,{})})})})]})};export{re as default};
