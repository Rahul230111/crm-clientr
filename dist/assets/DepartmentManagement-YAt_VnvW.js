import{r as f,M as m,K as e,Q as o,aX as I,W as v,aw as E,Y as R,ag as $,a3 as A,aW as O,$ as p,aj as i}from"./index-FVmEbnB1.js";import{P as _}from"./index-BTVJIO-A.js";const q=({departments:D,fetchDepartments:u,fetchTeams:x,fetchUsers:g})=>{const[w,n]=f.useState(!1),[l,j]=f.useState(null),[c]=m.useForm(),r=JSON.parse(localStorage.getItem("user")),y=(r==null?void 0:r.role)==="Superadmin",h=(r==null?void 0:r.role)==="Admin",C=()=>{j(null),c.resetFields(),n(!0)},b=a=>{j(a),c.setFieldsValue({name:a.name,description:a.description}),n(!0)},F=async()=>{var a,s;try{const t=await c.validateFields();l?(await p.put(`/api/departments/${l._id}`,t),i.success("Department updated successfully")):(await p.post("/api/departments",t),i.success("Department created successfully")),n(!1),u(),x(),g()}catch(t){console.error(t),i.error(((s=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to submit department")}},S=async a=>{var s,t;try{await p.delete(`/api/departments/${a}`),i.success("Department deleted"),u(),x(),g()}catch(d){i.error(((t=(s=d==null?void 0:d.response)==null?void 0:s.data)==null?void 0:t.message)||"Delete failed")}},k=[{title:"Name",dataIndex:"name",key:"name"},{title:"Actions",key:"actions",render:(a,s)=>e.jsx($,{children:(y||h)&&e.jsxs(e.Fragment,{children:[e.jsx(o,{icon:e.jsx(A,{}),onClick:()=>b(s)}),e.jsx(_,{title:"Delete this department?",onConfirm:()=>S(s._id),children:e.jsx(o,{danger:!0,icon:e.jsx(O,{})})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Department Management"}),(y||h)&&e.jsx(o,{type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},icon:e.jsx(I,{}),onClick:C,children:"Create Department"})]}),e.jsx(v,{columns:k,dataSource:D,rowKey:"_id",bordered:!0}),e.jsx(E,{title:l?"Edit Department":"Create Department",open:w,onClose:()=>n(!1),width:420,destroyOnClose:!0,footer:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(o,{onClick:()=>n(!1),style:{marginRight:8},children:"Cancel"}),e.jsx(o,{type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},onClick:F,children:l?"Update":"Create"})]}),children:e.jsx(m,{form:c,layout:"vertical",children:e.jsx(m.Item,{name:"name",label:"Department Name",rules:[{required:!0,message:"Department name is required"}],children:e.jsx(R,{})})})})]})};export{q as default};
